<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Update to OAuth 2.0 Protected Resource Metadata Resource Identifier Validation</title>
<meta content="Karl McGuinness" name="author">
<meta content="Aaron Parecki" name="author">
<meta content="
       RFC 9728 defines OAuth 2.0 Protected Resource Metadata, enabling clients to dynamically discover the authorization requirements of protected resources.  Section 3.3 of RFC 9728 requires that when protected resource metadata is obtained via a  WWW-Authenticate  challenge, the  resource  value in the metadata  MUST  exactly match the URL the client used to access the protected resource, limiting the applicability of the specification. 
       This document updates the resource validation rule in Section 3.3 of RFC 9728 to permit the  resource  value to be any URI that shares the same TLS origin (scheme, host, and port) as the requested URL and whose path is a prefix of the request URL path. This enables a wider range of use cases for the  WWW-Authenticate  response. All other aspects of RFC 9728 remain unchanged. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="OAuth 2.0" name="keyword">
<meta content="Protected Resource Metadata" name="keyword">
<meta content="Resource Indicator" name="keyword">
<meta content="draft-mcguinness-oauth-rfc9728bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-mcguinness-oauth-rfc9728bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Updated PRM Resource Validation</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">McGuinness &amp; Parecki</td>
<td class="center">Expires 28 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mcguinness-oauth-rfc9728bis-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc9728" class="eref">9728</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-24" class="published">24 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-28">28 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. McGuinness</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">A. Parecki</div>
<div class="org">Okta</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Update to OAuth 2.0 Protected Resource Metadata Resource Identifier Validation</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">RFC 9728 defines OAuth 2.0 Protected Resource Metadata, enabling clients to dynamically discover the authorization requirements of protected resources.  Section 3.3 of RFC 9728 requires that when protected resource metadata is obtained via a <code>WWW-Authenticate</code> challenge, the <code>resource</code> value in the metadata <span class="bcp14">MUST</span> exactly match the URL the client used to access the protected resource, limiting the applicability of the specification.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document updates the resource validation rule in Section 3.3 of RFC 9728 to permit the <code>resource</code> value to be any URI that shares the same TLS origin (scheme, host, and port) as the requested URL and whose path is a prefix of the request URL path. This enables a wider range of use cases for the <code>WWW-Authenticate</code> response. All other aspects of RFC 9728 remain unchanged.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://mcguinness.github.io/draft-mcguinness-oauth-rfc9728bis/draft-mcguinness-oauth-rfc9728bis.html">https://mcguinness.github.io/draft-mcguinness-oauth-rfc9728bis/draft-mcguinness-oauth-rfc9728bis.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-mcguinness-oauth-rfc9728bis/">https://datatracker.ietf.org/doc/draft-mcguinness-oauth-rfc9728bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/mcguinness/draft-mcguinness-oauth-rfc9728bis">https://github.com/mcguinness/draft-mcguinness-oauth-rfc9728bis</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-update-to-rfc-9728-section-" class="internal xref">Update to RFC 9728 Section 3.3</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-original-rule-replaced" class="internal xref">Original Rule (Replaced)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-updated-validation-rule" class="internal xref">Updated Validation Rule</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-path-prefix-matching" class="internal xref">Path Prefix Matching</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-host-level-resource-identif" class="internal xref">Host-Level Resource Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-path-level-resource-identif" class="internal xref">Path-Level Resource Identifier</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-client-token-caching-guidan" class="internal xref">Client Token Caching Guidance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-preservation-of-origin-secu" class="internal xref">Preservation of Origin Security Boundary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-path-level-isolation" class="internal xref">Path-Level Isolation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-token-scope-and-audience" class="internal xref">Token Scope and Audience</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-sender-constrained-tokens" class="internal xref">Sender-Constrained Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-metadata-substitution-withi" class="internal xref">Metadata Substitution Within an Origin</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-resource-discovery-for-fine" class="internal xref">Resource Discovery for Fine-Grained APIs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-exact-match-constraint" class="internal xref">Exact-Match Constraint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-resolution-with-the-updated" class="internal xref">Resolution with the Updated Rule</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document updates one specific aspect of OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>: the resource validation rule defined in Section 3.3.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> requires that when a client retrieves protected resource metadata from a URL obtained via a <code>WWW-Authenticate</code> challenge, the <code>resource</code> value in the metadata response <span class="bcp14">MUST</span> be identical to the URL the client used to make the request that triggered the challenge.  This exact-match rule is intended to prevent a malicious resource from directing clients to metadata that impersonates a different resource.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Consider a resource server at <code>https://api.example.com</code> that exposes the following protected resources:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1"><code>https://api.example.com/accounts</code><a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1"><code>https://api.example.com/transactions</code><a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.3">
          <p id="section-1-4.3.1"><code>https://api.example.com/profile</code><a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">All three protected resources are served by the same authorization server (<code>https://as.example.com</code>) and accept tokens with the same audience (<code>https://api.example.com</code>).<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Under the current Section 3.3 rule in <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, when a client calls <code>https://api.example.com/transactions</code> without a token, the resource server responds:<a href="#section-1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1-7">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata="https://api.example.com/.well-known/oauth-protected-resource/transactions"
</pre><a href="#section-1-7" class="pilcrow">¶</a>
</div>
<p id="section-1-8">The client retrieves the metadata, which per Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> <span class="bcp14">MUST</span> contain a <code>resource</code> value identical to the request URL:<a href="#section-1-8" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-1-9">
<pre>
{
  "resource": "https://api.example.com/transactions",
  "authorization_servers": ["https://as.example.com"],
  ...
}
</pre><a href="#section-1-9" class="pilcrow">¶</a>
</div>
<p id="section-1-10">The client then requests a token using <code>https://api.example.com/transactions</code> as the <code>resource</code> parameter per <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.  The authorization server may issue a token whose audience is <code>https://api.example.com</code> (covering all protected resources on the server), but the client has no standardized way to know this.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">When the client subsequently needs to access <code>https://api.example.com/accounts</code>, it faces one of the following suboptimal outcomes:<a href="#section-1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-12">
<li id="section-1-12.1">
          <p id="section-1-12.1.1">It repeats the entire discovery and token-request flow for the new protected resource, wasting a round trip to the authorization server.<a href="#section-1-12.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-12.2">
          <p id="section-1-12.2.1">It speculatively reuses the existing token, which may work but is not grounded in any protocol signal from the resource server.<a href="#section-1-12.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-12.3">
          <p id="section-1-12.3.1">The authorization server must understand and enumerate every per-URL resource identifier that maps to a given audience, increasing configuration complexity.<a href="#section-1-12.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-13">To avoid these outcomes, this document relaxes the exact-match requirement for <code>resource</code> values obtained via <code>WWW-Authenticate</code> discovery to a same-origin, path-prefix match.  See <a href="#update-section-3-3" class="auto internal xref">Section 4</a> for the normative specification.  <a href="#appendix-fine-grained" class="auto internal xref">Appendix A</a> provides a non-normative example illustrating how the updated rule applies to APIs with fine-grained resource URLs.<a href="#section-1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">This document uses the following terms as defined in the referenced specifications:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">resource identifier:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
          <p id="section-3-2.2.1">An HTTPS URI that identifies a protected resource or set of protected resources, as defined in Section 1.2 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> and <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">TLS origin:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">
          <p id="section-3-2.4.1">The combination of scheme, host, and port derived from a URI, as defined in Section 4.3.2 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> for the <code>https</code> scheme. Two URIs share the same TLS origin if and only if their scheme, host, and port (after applying default port rules) are identical.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">path prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">
          <p id="section-3-2.6.1">A path that matches the beginning of another path on a segment boundary.  See <a href="#path-prefix-matching" class="auto internal xref">Section 4.3</a> for the precise definition.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">request URL:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.8">
          <p id="section-3-2.8.1">The URL the client used to make the request that triggered the WWW-Authenticate challenge.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="update-section-3-3">
<section id="section-4">
      <h2 id="name-update-to-rfc-9728-section-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-update-to-rfc-9728-section-" class="section-name selfRef">Update to RFC 9728 Section 3.3</a>
      </h2>
<p id="section-4-1">This section contains the normative change to <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.  It updates only the resource validation rule in Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> that applies when metadata is retrieved via a <code>WWW-Authenticate</code> challenge.  All other requirements in Section 3.3 and the rest of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> remain in effect.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="original-rule-replaced">
<section id="section-4.1">
        <h3 id="name-original-rule-replaced">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-original-rule-replaced" class="section-name selfRef">Original Rule (Replaced)</a>
        </h3>
<p id="section-4.1-1">Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> states:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">If the protected resource metadata was retrieved from a URL returned by the protected resource via the <code>WWW-Authenticate</code> <code>resource_metadata</code> parameter, then the <code>resource</code> value returned <span class="bcp14">MUST</span> be identical to the URL that the client used to make the request to the resource server. If these values are not identical, the data contained in the response <span class="bcp14">MUST NOT</span> be used.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">This document replaces the above requirement with the updated rule in <a href="#updated-rule" class="auto internal xref">Section 4.2</a>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="updated-rule">
<section id="section-4.2">
        <h3 id="name-updated-validation-rule">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-updated-validation-rule" class="section-name selfRef">Updated Validation Rule</a>
        </h3>
<p id="section-4.2-1">When a client retrieves protected resource metadata from a URL obtained via the <code>resource_metadata</code> parameter in a <code>WWW-Authenticate</code> challenge (as defined in Section 5 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>), the client <span class="bcp14">MUST</span> verify ALL of the following conditions using the <code>resource</code> value from the metadata response and the URL the client used to make the request that triggered the challenge:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-2">
<li id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">The scheme of the <code>resource</code> value <span class="bcp14">MUST</span> be <code>https</code>.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">The host of the <code>resource</code> value <span class="bcp14">MUST</span> be identical (using case-insensitive comparison) to the host of the request URL.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-2.3">
            <p id="section-4.2-2.3.1">The port of the <code>resource</code> value <span class="bcp14">MUST</span> be identical to the port of the request URL.  If either URL omits the port, the default port for the <code>https</code> scheme (443) <span class="bcp14">MUST</span> be used for comparison.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-2.4">
            <p id="section-4.2-2.4.1">The path of the <code>resource</code> value <span class="bcp14">MUST</span> be a prefix of the path of the request URL, as defined in <a href="#path-prefix-matching" class="auto internal xref">Section 4.3</a>.<a href="#section-4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.2-3">If any of these conditions are not met, the client <span class="bcp14">MUST NOT</span> use the metadata, consistent with the security requirements of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Note that when the <code>resource</code> value is identical to the request URL, all four conditions are trivially satisfied.  This means the updated rule is fully backwards compatible with the original exact-match rule in <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>: any metadata that was valid under the original rule remains valid under this update.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">This update only applies to metadata retrieved via a <code>WWW-Authenticate challenge</code>. The validation rule for metadata retrieved directly from a well-known URI is NOT changed by this document; the <code>resource</code> value <span class="bcp14">MUST</span> still be identical to the resource identifier from which the well-known URI was derived, as specified in Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-prefix-matching">
<section id="section-4.3">
        <h3 id="name-path-prefix-matching">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-path-prefix-matching" class="section-name selfRef">Path Prefix Matching</a>
        </h3>
<p id="section-4.3-1">This section defines the path prefix matching algorithm referenced by condition 4 of the updated validation rule in <a href="#updated-rule" class="auto internal xref">Section 4.2</a>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The path of the <code>resource</code> value is a prefix of the path of the request URL if any of the following conditions hold:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-3">
<li id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">The paths are identical (exact match).<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">The <code>resource</code> path ends with <code>/</code> and the request URL path starts with the <code>resource</code> path.  For example, a <code>resource</code> path of <code>/api/v1/</code> is a prefix of a request URL path of <code>/api/v1/accounts</code>.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-3.3">
            <p id="section-4.3-3.3.1">The <code>resource</code> path does not end with <code>/</code>, and the request URL path is the <code>resource</code> path followed by <code>/</code> and optionally additional segments.  For example, a <code>resource</code> path of <code>/api/v1</code> is a prefix of request URL paths <code>/api/v1/</code> and <code>/api/v1/accounts</code>.<a href="#section-4.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-4">Matching <span class="bcp14">MUST</span> occur on segment boundaries.  A <code>resource</code> path <span class="bcp14">MUST NOT</span> be treated as a prefix if the match would split a path segment. For example, a <code>resource</code> path of <code>/api/v1</code> <span class="bcp14">MUST NOT</span> match a request URL path of <code>/api/v10</code> or <code>/api/v1admin</code>, because <code>v10</code> and <code>v1admin</code> are distinct path segments from <code>v1</code>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">Paths <span class="bcp14">MUST</span> be compared in their URI-normalized form per <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>. Percent-encoded characters <span class="bcp14">MUST</span> be decoded before comparison.  An empty or absent path <span class="bcp14">MUST</span> be treated as <code>/</code> for comparison purposes.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The following table illustrates the matching behavior:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">resource path</th>
              <th class="text-left" rowspan="1" colspan="1">Request URL path</th>
              <th class="text-left" rowspan="1" colspan="1">Match?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v10</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No</strong>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1admin</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No</strong>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v2/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No</strong>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/api/v1</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/other</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No</strong>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/accounts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>/transactions</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No</strong>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-5">
      <h2 id="name-examples">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-5-1">This section is non-normative.  It illustrates how the updated validation rule in <a href="#update-section-3-3" class="auto internal xref">Section 4</a> applies in practice.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="host-level-resource-identifier">
<section id="section-5.1">
        <h3 id="name-host-level-resource-identif">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-host-level-resource-identif" class="section-name selfRef">Host-Level Resource Identifier</a>
        </h3>
<p id="section-5.1-1">A resource server at <code>https://api.example.com</code> advertises a host-level resource identifier covering all of its protected resources.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">When a client requests <code>https://api.example.com/transactions</code> without a token:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata="https://api.example.com/.well-known/oauth-protected-resource"
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The metadata response contains:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1-5">
<pre>
{
  "resource": "https://api.example.com/",
  "authorization_servers": ["https://as.example.com"],
  "scopes_supported": ["accounts.read", "transactions.read",
    "profile.read"]
  ...
}
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">The client validates that <code>https://api.example.com/</code> shares the same TLS origin as <code>https://api.example.com/transactions</code> and that the path <code>/</code> is a prefix of <code>/transactions</code>.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-level-resource-identifier">
<section id="section-5.2">
        <h3 id="name-path-level-resource-identif">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-path-level-resource-identif" class="section-name selfRef">Path-Level Resource Identifier</a>
        </h3>
<p id="section-5.2-1">A resource server at <code>https://platform.example.com</code> exposes two independent sets of protected resources under different path prefixes.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">When a client requests <code>https://platform.example.com/api/v1/transactions</code> without a token:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-3">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata="https://platform.example.com/.well-known/oauth-protected-resource/api/v1"
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2-4">The metadata response contains:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.2-5">
<pre>
{
  "resource": "https://platform.example.com/api/v1",
  "authorization_servers": ["https://as.example.com"],
  "scopes_supported": ["transactions.read", "accounts.read"]
  ...
}
</pre><a href="#section-5.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2-6">The client validates that <code>https://platform.example.com/api/v1</code> shares the same TLS origin as <code>https://platform.example.com/api/v1/transactions</code> and that the path <code>/api/v1</code> is a prefix of <code>/api/v1/transactions</code> on a segment boundary.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">A subsequent request to <code>https://platform.example.com/api/v2/reports</code> would NOT match the resource <code>https://platform.example.com/api/v1</code> because <code>/api/v1</code> is not a prefix of <code>/api/v2/reports</code>.  The client would need to perform a separate discovery for the <code>/api/v2</code> protected resources.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-caching">
<section id="section-6">
      <h2 id="name-client-token-caching-guidan">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-client-token-caching-guidan" class="section-name selfRef">Client Token Caching Guidance</a>
      </h2>
<p id="section-6-1">This section is non-normative.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A client <span class="bcp14">MAY</span> maintain a token cache keyed by the tuple <code>(authorization_server, resource)</code>, where <code>authorization_server</code> is the issuer identifier from which the token was obtained and <code>resource</code> is the <code>resource</code> value from the protected resource metadata.  A cached token <span class="bcp14">MAY</span> be reused for requests to any URL whose path falls under the same <code>resource</code> path prefix on the same TLS origin, provided the token was obtained from the same authorization server, has not expired, and carries sufficient scopes.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A client <span class="bcp14">MAY</span> also optimistically reuse a cached token when accessing a URL under the same resource path prefix before performing metadata discovery for that URL.  If the resource server rejects the token (e.g., with a 401 response), the client falls back to the standard discovery flow.  The client should not assume that all protected resources under a given path prefix accept the same token.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The security considerations of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> (Section 7) continue to apply in full.  This section describes how the updated validation rule in <a href="#update-section-3-3" class="auto internal xref">Section 4</a> interacts with those considerations.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="preservation-of-origin-security-boundary">
<section id="section-7.1">
        <h3 id="name-preservation-of-origin-secu">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-preservation-of-origin-secu" class="section-name selfRef">Preservation of Origin Security Boundary</a>
        </h3>
<p id="section-7.1-1">Section 7.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> describes impersonation attacks where an adversary publishes metadata claiming to represent a legitimate resource.  The updated validation rule in <a href="#updated-rule" class="auto internal xref">Section 4.2</a> maintains the fundamental security property that prevents these attacks: the TLS origin check (conditions 1-3) ensures that the <code>resource</code> value is authoritative for the same server that issued the challenge.  An attacker who controls <code>https://evil.example.com</code> cannot cause a client to accept metadata with a <code>resource</code> value of <code>https://api.example.com/</code>, because the origins differ.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-level-isolation">
<section id="section-7.2">
        <h3 id="name-path-level-isolation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-path-level-isolation" class="section-name selfRef">Path-Level Isolation</a>
        </h3>
<p id="section-7.2-1">Some deployments host multiple independent services on the same origin, distinguished only by path (e.g., a shared hosting environment where <code>https://shared.example.com/serviceA</code> and <code>https://shared.example.com/serviceB</code> are operated by different tenants).  The path-prefix matching rule in this document supports these deployments: each service can advertise its own path-scoped resource identifier (e.g., <code>https://shared.example.com/serviceA</code>) that covers only protected resources under that path prefix.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">Resource servers in multi-tenant environments <span class="bcp14">SHOULD</span> use path-specific resource identifiers that maintain the necessary isolation between tenants.  A resource identifier of <code>https://shared.example.com/serviceA</code> will not match requests to <code>https://shared.example.com/serviceB/resource</code> because <code>/serviceA</code> is not a path prefix of <code>/serviceB/resource</code>.  This ensures that tokens obtained for one service cannot be inadvertently reused for another service on the same origin.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-scope-and-audience">
<section id="section-7.3">
        <h3 id="name-token-scope-and-audience">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-token-scope-and-audience" class="section-name selfRef">Token Scope and Audience</a>
        </h3>
<p id="section-7.3-1">Relaxing the resource matching rule does not change the authorization server's responsibility to enforce audience restrictions on issued tokens.  The authorization server remains the authority on what resource(s) a token is valid for.  A client's use of a resource identifier (whether host-level or path-scoped) as the <code>resource</code> parameter in a token request is a signal to the authorization server, which <span class="bcp14">MAY</span> issue a token with a narrower or broader audience at its discretion.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sender-constrained-tokens">
<section id="section-7.4">
        <h3 id="name-sender-constrained-tokens">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-sender-constrained-tokens" class="section-name selfRef">Sender-Constrained Tokens</a>
        </h3>
<p id="section-7.4-1">Deployments using sender-constrained tokens (e.g., DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>) are compatible with the relaxed matching rule defined in this document.  The sender constraint binds the token to the client, not to a specific protected resource, so token reuse across protected resources on the same origin does not weaken the sender-constraint security property.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-substitution-within-an-origin">
<section id="section-7.5">
        <h3 id="name-metadata-substitution-withi">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-metadata-substitution-withi" class="section-name selfRef">Metadata Substitution Within an Origin</a>
        </h3>
<p id="section-7.5-1">The updated validation rule in <a href="#updated-rule" class="auto internal xref">Section 4.2</a> permits a protected resource to direct clients to metadata with a <code>resource</code> value that differs from the URL of the protected resource (but shares the same origin and satisfies the path-prefix condition).  This means that a compromised protected resource on an origin could direct clients to metadata controlled by another protected resource on the same origin. This risk is inherent to same-origin trust and is no different from the existing web security model, where all content on the same origin shares a trust boundary.  This risk also exists under the original <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> rule, since a compromised protected resource can already return arbitrary WWW-Authenticate challenges.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9728">[RFC9728]</dt>
        <dd>
<span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="seriesInfo">RFC 9728</span>, <span class="seriesInfo">DOI 10.17487/RFC9728</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9728">https://www.rfc-editor.org/info/rfc9728</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mcguinness-oauth-resource-token-resp">[I-D.mcguinness-oauth-resource-token-resp]</dt>
      <dd>
<span class="refAuthor">McGuinness, K.</span> and <span class="refAuthor">J. Hanson</span>, <span class="refTitle">"OAuth 2.0 Resource Parameter in Access Token Response"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mcguinness-oauth-resource-token-resp-01</span>, <time datetime="2025-12-21" class="refDate">21 December 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mcguinness-oauth-resource-token-resp-01">https://datatracker.ietf.org/doc/html/draft-mcguinness-oauth-resource-token-resp-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="appendix-fine-grained">
<section id="appendix-A">
      <h2 id="name-resource-discovery-for-fine">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-resource-discovery-for-fine" class="section-name selfRef">Resource Discovery for Fine-Grained APIs</a>
      </h2>
<p id="appendix-A-1">This non-normative example illustrates a common deployment pattern where the original exact-match validation rule in Section 3.3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> creates a barrier to adoption, and shows how the updated rule in <a href="#update-section-3-3" class="auto internal xref">Section 4</a> resolves it.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="exact-match-constraint">
<section id="appendix-A.1">
        <h3 id="name-exact-match-constraint">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-exact-match-constraint" class="section-name selfRef">Exact-Match Constraint</a>
        </h3>
<p id="appendix-A.1-1">Consider a resource server that exposes individual user resources at unique URLs of the form <code>https://example.com/users/{id}</code>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">A client that does not yet hold an access token makes a <code>GET</code> request to the resource.  The resource server responds with <code>401 Unauthorized</code> and a <code>WWW-Authenticate</code> challenge identifying the Protected Resource Metadata document:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-3">
<pre>
GET /users/100 HTTP/1.1
Host: example.com

HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata=
  "https://example.com/.well-known/oauth-protected-resource"
</pre><a href="#appendix-A.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-4">Following the discovery procedure in Section 3 of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, the client retrieves the metadata document:<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-5">
<pre>
GET /.well-known/oauth-protected-resource HTTP/1.1
Host: example.com

HTTP/1.1 200 OK
Content-Type: application/json

{
  "resource": "https://example.com/users/",
  "authorization_servers": ["https://as.example.com"],
  ...
}
</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-6">Under the original Section 3.3 rule of <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, the <code>resource</code> value <span class="bcp14">MUST</span> be identical to the request URL <code>https://example.com/users/100</code>.  Because the metadata instaed contains an invalid value of <code>https://example.com/users/</code>, the client <span class="bcp14">MUST NOT</span> use the metadata.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">To satisfy the original exact-match requirement, a resource server has two options.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.1-8"><strong>Option 1: A distinct metadata document per resource URL.</strong><a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
<p id="appendix-A.1-9">Each resource URL requires its own Protected Resource Metadata document, for example:<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-10">
<pre>
https://example.com/users/100/.well-known/...
https://example.com/users/101/.well-known/...
https://example.com/users/102/.well-known/...
...
</pre><a href="#appendix-A.1-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-11">For APIs where the set of resource URLs is not fixed in advance, this creates an unbounded number of metadata documents to provision, serve, and keep consistent.  In practice this results in increased storage overhead, cache fragmentation, and operational complexity that scales linearly with the number of resources.<a href="#appendix-A.1-11" class="pilcrow">¶</a></p>
<p id="appendix-A.1-12"><strong>Option 2: Out-of-band knowledge of a representative resource URL.</strong><a href="#appendix-A.1-12" class="pilcrow">¶</a></p>
<p id="appendix-A.1-13">To work around the exact-match constraint, a client could first make a <code>GET</code> request to a "parent" resource (e.g., <code>https://example.com/users</code>) in order to trigger a <code>401 Unauthorized</code> response whose associated metadata contains a <code>resource</code> value of <code>https://example.com/users</code>.  The client would perform discovery against that URL, obtain an access token, and then use the access token to access <code>https://example.com/users/100</code>.<a href="#appendix-A.1-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-14">
<pre>
GET /users HTTP/1.1
Host: example.com

HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata=
  "https://example.com/.well-known/oauth-protected-resource"
</pre><a href="#appendix-A.1-14" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-15">This approach requires out-of-band knowledge of which URL to request first, which is not conveyed by the protocol.  It also introduces an additional round trip before the client can access the originally desired resource, increasing latency and complexity for every new client interaction.<a href="#appendix-A.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resolution-with-the-updated-rule">
<section id="appendix-A.2">
        <h3 id="name-resolution-with-the-updated">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-resolution-with-the-updated" class="section-name selfRef">Resolution with the Updated Rule</a>
        </h3>
<p id="appendix-A.2-1">The updated validation rule in <a href="#updated-rule" class="auto internal xref">Section 4.2</a> permits the <code>resource</code> value to be any URI that shares the same TLS origin as the request URL and whose path is a prefix of the request URL path.  This allows a single metadata document to cover a collection of related resources, enabling straightforward discovery with no additional round trips or out-of-band coordination.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">A client that does not yet hold an access token makes a <code>GET</code> request to the resource.  The resource server responds with <code>401 Unauthorized</code> and a <code>WWW-Authenticate</code> challenge:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-3">
<pre>
GET /users/100 HTTP/1.1
Host: example.com

HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata=
  "https://example.com/.well-known/oauth-protected-resource"
</pre><a href="#appendix-A.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-4">The client retrieves the metadata document:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5">
<pre>
GET /.well-known/oauth-protected-resource HTTP/1.1
Host: example.com

HTTP/1.1 200 OK
Content-Type: application/json

{
  "resource": "https://example.com/users/",
  "authorization_servers": ["https://as.example.com"],
  ...
}
</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-6">The client validates that <code>https://example.com/users/</code> shares the same TLS origin as <code>https://example.com/users/100</code> and that the path <code>/users/</code> is a prefix of <code>/users/100</code> on a segment boundary.  Both conditions are satisfied, so the client accepts the metadata.<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2-7">The client uses <code>https://example.com/users/</code> as the resource indicator (per <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>) when requesting an access token from the authorization server.  The resulting access token can be reused for subsequent requests to <code>https://example.com/users/101</code>, <code>https://example.com/users/102</code>, and so on without repeating the discovery or token-request flow.<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank the members of the OAuth Working Group and MCP Authorization Working Group for their feedback and discussion on the challenges of dynamic resource discovery and cross-resource token reuse.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-01<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Resolved merge error for publication<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-00<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Initial version.<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karl McGuinness</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:public@karlmcguinness.com" class="email">public@karlmcguinness.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aaron Parecki</span></div>
<div dir="auto" class="left"><span class="org">Okta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aaron.parecki@okta.com" class="email">aaron.parecki@okta.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
